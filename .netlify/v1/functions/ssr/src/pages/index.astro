---
import { Image } from "astro:assets";
import Layout from '@/layouts/Layout.astro';
import Container from "@/components/main-components/Container.astro";
import { Button } from "@/components/ui/button.tsx";

import { getAllProducts, getProductByCategory } from "@/lib/api.ts";
import type { AllProductTypes } from "@/types.d.ts";

import { TestCarousel } from "@/features/product/ProductCarousel.tsx";

import ProductLists from "../features/product/ProductsLists.tsx";
import CardProduct from "@/features/product/card-product.tsx";
import { CardByCategory } from "@/components/card-product.tsx"

import LandingPage from "@/assets/images/landing_page.jpg";


interface CardCategoryProps {
  name: string;
};


const products = await getAllProducts();
const productsCategory = await getProductByCategory()
---

<Layout>
  <div class="relative z-20 mt-14">
    <Image class="w-full h-full aspect-video object-cover" src={LandingPage} alt="photo" width={1600} height={600} />
    <div class="absolute top-10 right-10 z-10 text-end text-white w-fit sm:top-20 sm:right-20">
      <h1 class="text-2xl font-SatoshiBold sm:text-4xl">New Collections</h1>
      <p class="w-64 sm:text-xl sm:w-full">sint proident occaecat laborum amet officia non</p>
      <Button className="mt-2 font-SatoshiMedium uppercase h-8 rounded-md px-3">Shop Now</Button>
    </div>
  </div>
	<Container class="max-w-full">
	  <div class="w-full flex justify-between items-center">
	    <h2 class="font-SatoshiBold sm:text-2xl">Shop By Category</h2>
	    <a class="font-SatoshiLight hover:underline underline-offset-4 sm:text-xl " href="/">See All</a>
	  </div>
	  <div class="grid grid-cols-2 gap-4 mt-4 sm:grid-cols-3">
	    <CardByCategory src="/assets/images/Furniture.png" title="Furniture" client:load />
	    <CardByCategory src="/assets/images/handbag.png" title="HandBag" client:load />
	    <CardByCategory src="/assets/images/books.png" title="Books" client:load />
	    <CardByCategory src="/assets/images/tech.png" title="Tech" client:load />
	    <CardByCategory src="/assets/images/sneakers.png" title="Sneakers" client:load />
	    <CardByCategory src="/assets/images/travel.png" title="Travel" client:load />
	  </div>
	</Container>
	<Container class="py-0 -mb-12">
	  <TestCarousel client:load initialScroll={0}>
      {products.slice(0, 7).map((item: AllProductTypes) => (
        <CardProduct
          id={item.id}
          discount={item.discountPercentage}
          name={item.title}
          price={item.price}
          rating={item.rating}
          className="w-40 sm:w-50"
        >
          <img
            alt={item.title}
            class="w-full h-fit w-full aspect-square object-cover bg-gray-100"
            src={item.thumbnail}
            width="200"
            height="200"
            loading="lazy"
          />
        </CardProduct>
      ))}
    </TestCarousel>
	</Container>
	<Container class="sticky top-14 bg-white z-40">
	  <div class="flex flex-row w-full h-full overflow-x-scroll gap-x-3.5 scrollbar">
	    {productsCategory.slice(0, 8).map((item: CardCategoryProps) => (
	      <a href="/" class="shrink-0 rounded-full font-SatoshiMedium border border-slate-500 px-2 rounded-md">{item.name}</a>
	    ))}
	  </div>
	</Container>
	
	<Container>
	  <ProductLists client:load />
	</Container>
</Layout>

